# Frida

### Install Frida: 
- - - 
- Server : [Frida Server Github](https://github.com/frida/frida/releases)
- Client : `sudo python -m pip install frida-tools`


### Usage
---

1.  Extract Frida Server dan push ke Emulator

```bash
$ adb push frida-server-x.x.x-android-x86 /data/local/tmp
```

2. Masuk ke shell menggunakan adb dan pergi ke `/data/local/tmp` letak frida server berada

```bash
$ adb shell
$ cd /data/loca/tmp
```

3. Change permission agar menjadi executable dan jalankan frida

```bash
$ chmod +x frida-server-x.x.x-android-x86
$ ./frida-server-x.x.x-android-x86
```

4. Pada Attacker Box/Mesin kita jalankan frida client dan pastikan ketika menjalankan frida client terlihat ada frida-server yang menandakan berhasil dijalankan

```bash
$ frida-ps -Uai
```


### Frida Hook Usage
---
Kita akan menggunakan uncrackable sebagai contoh untuk menggunakan hook yang akan membypass root/emu detection, berikut adalah source code untuk mendeteksi root/emu dari uncrackable
```java
package sg.vantagepoint.a;
import android.os.Build;
import java.io.File;

public class c {
   public static boolean a() {
   	for (String file : System.getenv("PATH").split(":")) {
       	if (new File(file, "su").exists()) {
           	return true;
       	}
   	}
   	return false;
   }

   public static boolean b() {
   	String str = Build.TAGS;
   	return str != null && str.contains("test-keys");
   }

   public static boolean c() {
   	for (String file : new String[]{"/system/app/Superuser.apk", "/system/xbin/daemonsu", "/system/etc/init.d/99SuperSUDaemon", "/system/bin/.ext/.su", "/system/etc/.has_su_daemon", "/system/etc/.installed_su_daemon", "/dev/com.koushikdutta.superuser.daemon/"}) {
       	if (new File(file).exists()) {
           	return true;
       	}
   	}
   	return false;
   }
}
```

Lalu kita akan membuat sebuah script dari JavaScript yang dimana nanti akan melakukan bypass source code di atas seperti berikut

```js
Java.perform(function () {
  console.log("Frida script is runnning");
  var c = Java.use('sg.vantagepoint.a.c');
  c.c.implementation = function () {
    console.log("Inside c.c()");
    return false;
  }
  c.b.implementation = function () {
    console.log("Inside c.b()");
    return false;
  }
  c.a.implementation = function () {
    console.log("Inside c.a()");
    return false;
  }
});
```

Tujuan dari script di atas adalah membuat method a,b,c pada class c menjadi false. Setelah itu kita jalankan frida pada Attacker Box/Mesin kita untuk mengeksekusi script hook yang telah dibuat

```bash
$ frida -U -l hook.js -f owasp.mstg.uncrackable1 --no-pause
```

Dan sudah tidak terdapat root detected lagi